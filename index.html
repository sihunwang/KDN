<!-- 
#카맵에 필지를 보여주는 html

실행 방법: 
A.(가장 편리) run_server.py 폴더를 더블클릭

B.
1.터미널에 입력 
python -m http.server 7000

2.웹 브라우저에 입력 
http://10.254.0.43:7000/kmap_farm.html

-->

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>필지 표기</title>
  <style>
    #map { width: 100%; height: 100vh; }
  </style>
</head>
<body>
  <div id="map">로딩 중...</div>

  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=1ad75a2e17c40ab7a045a04f5fdba63c&libraries=services"></script>

  <script>
    fetch('parcel_data.json')
      .then(response => response.json())
      .then(data => {
        if (!data || data.length === 0) {
          alert("❌ JSON 데이터 없음!");
          return;
        }

        // 중심 좌표: 첫 좌표
        const center = new kakao.maps.LatLng(data[0].coords[0][0], data[0].coords[0][1]);
        const map = new kakao.maps.Map(document.getElementById('map'), {
          center: center,
          level: 5
        });

        data.forEach(item => {
          const path = item.coords.map(coord => new kakao.maps.LatLng(coord[0], coord[1]));
          if (path.length >= 3) {
            const polygon = new kakao.maps.Polygon({
              path: [path],
              strokeWeight: 2,
              strokeColor: item.color || '#FF00FF',
              strokeOpacity: 0.8,
              fillColor: item.color || '#FF00FF',
              fillOpacity: 0.4
            });
            polygon.setMap(map);
          } else {
            console.warn(`❌ [${item.id}] 좌표 부족`);
          }
        });
      })
      .catch(err => {
        console.error('❌ JSON 파일 로딩 실패:', err);
      });
  </script>
</body>
</html>
